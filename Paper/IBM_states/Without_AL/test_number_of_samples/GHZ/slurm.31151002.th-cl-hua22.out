Matplotlib created a temporary config/cache directory at /tmp/matplotlib-hmzx43v6 because the default path (/home/h/Hannah.Lange/.config/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
Matplotlib is building the font cache; this may take a moment.
Start measurement of GHZ(100 configurations).
0 samples generated.
16 samples generated.
32 samples generated.
48 samples generated.
64 samples generated.
80 samples generated.
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/Test
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/../
Learn Training_data/Test: 96 samples.
Traceback (most recent call last):
  File "qiskit_example.py", line 38, in <module>
    tom.fit_routine(epochs, batchsize, lr, k, torch.optim.Adagrad, {}, torch.optim.lr_scheduler.MultiStepLR, {"milestones": [1000, 1500], "gamma": 0.75})
  File "/project/th-scratch/h/Hannah.Lange/Projektpraktikum/Part1_Projektpraktikum/without_AL/Tests/classical/GHZ/tomography.py", line 188, in fit_routine
    self.fit(epochs, learning_rate)
  File "/project/th-scratch/h/Hannah.Lange/Projektpraktikum/Part1_Projektpraktikum/without_AL/Tests/classical/GHZ/tomography.py", line 139, in fit
    scheduler_args=self.scheduler_args
  File "/project/th-scratch/h/Hannah.Lange/Projektpraktikum/Part2_Hiwi/Qucumber_Development/qucumber/nn_states/complex_wavefunction.py", line 253, in fit
    **kwargs
  File "/project/th-scratch/h/Hannah.Lange/Projektpraktikum/Part2_Hiwi/Qucumber_Development/qucumber/nn_states/neural_state.py", line 614, in fit
    all_grads = self.compute_batch_gradients(k, *batch)
  File "/project/th-scratch/h/Hannah.Lange/Projektpraktikum/Part2_Hiwi/Qucumber_Development/qucumber/nn_states/neural_state.py", line 439, in compute_batch_gradients
    grad = self.positive_phase_gradients(samples_batch, bases_batch=bases_batch)
  File "/project/th-scratch/h/Hannah.Lange/Projektpraktikum/Part2_Hiwi/Qucumber_Development/qucumber/nn_states/neural_state.py", line 382, in positive_phase_gradients
    grad = self.gradient(samples_batch, bases=bases_batch)
  File "/project/th-scratch/h/Hannah.Lange/Projektpraktikum/Part2_Hiwi/Qucumber_Development/qucumber/nn_states/neural_state.py", line 359, in gradient
    sample_grad = self.rotated_gradient(basis, samples[indices == i, :])
  File "/project/th-scratch/h/Hannah.Lange/Projektpraktikum/Part2_Hiwi/Qucumber_Development/qucumber/nn_states/complex_wavefunction.py", line 175, in rotated_gradient
    self, basis, sample, include_extras=True
  File "/project/th-scratch/h/Hannah.Lange/Projektpraktikum/Part2_Hiwi/Qucumber_Development/qucumber/utils/unitaries.py", line 215, in rotate_psi_inner_prod
    Ut, v = _rotate_basis_state(nn_state, basis, states, unitaries=unitaries)
  File "/project/th-scratch/h/Hannah.Lange/Projektpraktikum/Part2_Hiwi/Qucumber_Development/qucumber/utils/unitaries.py", line 166, in _rotate_basis_state
    v[..., sites] = nn_state.generate_hilbert_space(size=sites.size).unsqueeze(1)
IndexError: index 5 is out of bounds for dimension 0 with size 5
