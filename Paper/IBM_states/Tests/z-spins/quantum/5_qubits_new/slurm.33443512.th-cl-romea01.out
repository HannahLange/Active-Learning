Matplotlib created a temporary config/cache directory at /tmp/user/23375/matplotlib-9jiycd4c because the default path (/project/theorie/h/Hannah.Lange/.cache/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
Matplotlib is building the font cache; this may take a moment.
use quantum device ibmq_lima
------ Start GLOBAL rotations to different measurement configurations.------
Measure in Z basis.
Start measurement of 1(10 configurations).
0 samples generated.
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/1/withRotation/10samples/10samples
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/tmp
tensor([[1., 1., 1., 0., 1.],
        [1., 1., 1., 0., 1.],
        [1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1.]], dtype=torch.float64)
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.918437	KL = 0.425412
Epoch: 200	rescaled_fidelity = 0.935299	KL = 0.334447
Total time elapsed during training:  0.915 s
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.922986	KL = 0.400704
Epoch: 200	rescaled_fidelity = 0.937816	KL = 0.321006
Total time elapsed during training:  0.794 s
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.940081	KL = 0.308944
Epoch: 200	rescaled_fidelity = 0.944466	KL = 0.285677
Total time elapsed during training:  0.807 s
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.942706	KL = 0.295004
Epoch: 200	rescaled_fidelity = 0.941764	KL = 0.300004
Total time elapsed during training:  0.801 s
Measure in X basis.
Start measurement of 1(10 configurations).
0 samples generated.
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/1/withRotation/10samples/10samples
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/tmp
tensor([[1., 0., 0., 1., 0.],
        [1., 0., 0., 0., 0.],
        [1., 0., 0., 0., 0.],
        [1., 0., 0., 0., 0.],
        [0., 0., 0., 0., 1.],
        [0., 0., 1., 0., 1.],
        [0., 1., 1., 0., 1.],
        [1., 1., 0., 1., 1.],
        [0., 0., 1., 1., 1.],
        [1., 0., 1., 0., 0.]], dtype=torch.float64)
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.391606	KL = 4.687501
Epoch: 200	rescaled_fidelity = 0.388455	KL = 4.727892
Total time elapsed during training:  0.789 s
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.394128	KL = 4.655397
Epoch: 200	rescaled_fidelity = 0.389674	KL = 4.712219
Total time elapsed during training:  0.798 s
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.375676	KL = 4.895140
Epoch: 200	rescaled_fidelity = 0.370639	KL = 4.962630
Total time elapsed during training:  0.799 s
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.390297	KL = 4.704236
Epoch: 200	rescaled_fidelity = 0.386125	KL = 4.757965
Total time elapsed during training:  0.843 s
Measure in Y basis.
Start measurement of 1(10 configurations).
0 samples generated.
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/1/withRotation/10samples/10samples
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/tmp
tensor([[0., 0., 0., 1., 0.],
        [0., 0., 1., 1., 0.],
        [1., 0., 0., 0., 1.],
        [1., 1., 0., 0., 1.],
        [0., 0., 1., 0., 1.],
        [0., 0., 0., 1., 1.],
        [0., 0., 1., 1., 1.],
        [0., 0., 1., 1., 1.],
        [0., 1., 0., 0., 0.],
        [1., 0., 1., 0., 0.]], dtype=torch.float64)
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.383009	KL = 4.798485
Epoch: 200	rescaled_fidelity = 0.364762	KL = 5.042553
Total time elapsed during training:  0.786 s
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.388183	KL = 4.731393
Epoch: 200	rescaled_fidelity = 0.386435	KL = 4.753954
Total time elapsed during training:  0.788 s
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.361384	KL = 5.089066
Epoch: 200	rescaled_fidelity = 0.354577	KL = 5.184147
Total time elapsed during training:  0.825 s
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.397226	KL = 4.616255
Epoch: 200	rescaled_fidelity = 0.384432	KL = 4.779942
Total time elapsed during training:  0.827 s
[0.2516270525606735, 0.25317595432919393, 0.2854274898374477]
Using the Z basis for the amplitude measurements.
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/tmp
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/../
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/1/withRotation/10samples/10samples
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.918437	KL = 0.425412
Epoch: 200	rescaled_fidelity = 0.935299	KL = 0.334447
Epoch: 300	rescaled_fidelity = 0.945761	KL = 0.278826
Epoch: 400	rescaled_fidelity = 0.943461	KL = 0.291002
Epoch: 500	rescaled_fidelity = 0.948120	KL = 0.266372
Epoch: 600	rescaled_fidelity = 0.946888	KL = 0.272873
Epoch: 700	rescaled_fidelity = 0.943123	KL = 0.292793
Epoch: 800	rescaled_fidelity = 0.947859	KL = 0.267750
Epoch: 900	rescaled_fidelity = 0.952528	KL = 0.243180
Epoch: 1000	rescaled_fidelity = 0.952394	KL = 0.243881
Total time elapsed during training:  4.069 s
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.922986	KL = 0.400704
Epoch: 200	rescaled_fidelity = 0.937816	KL = 0.321006
Epoch: 300	rescaled_fidelity = 0.938323	KL = 0.318306
Epoch: 400	rescaled_fidelity = 0.944530	KL = 0.285338
Epoch: 500	rescaled_fidelity = 0.947641	KL = 0.268898
Epoch: 600	rescaled_fidelity = 0.947283	KL = 0.270788
Epoch: 700	rescaled_fidelity = 0.948614	KL = 0.263765
Epoch: 800	rescaled_fidelity = 0.951074	KL = 0.250816
Epoch: 900	rescaled_fidelity = 0.953892	KL = 0.236024
Epoch: 1000	rescaled_fidelity = 0.954752	KL = 0.231516
Total time elapsed during training:  4.013 s
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.940081	KL = 0.308944
Epoch: 200	rescaled_fidelity = 0.944466	KL = 0.285677
Epoch: 300	rescaled_fidelity = 0.949813	KL = 0.257450
Epoch: 400	rescaled_fidelity = 0.945718	KL = 0.279052
Epoch: 500	rescaled_fidelity = 0.949509	KL = 0.259054
Epoch: 600	rescaled_fidelity = 0.954078	KL = 0.235049
Epoch: 700	rescaled_fidelity = 0.951750	KL = 0.247265
Epoch: 800	rescaled_fidelity = 0.950040	KL = 0.256254
Epoch: 900	rescaled_fidelity = 0.955252	KL = 0.228901
Epoch: 1000	rescaled_fidelity = 0.950994	KL = 0.251240
Total time elapsed during training:  3.995 s
Learn Training_data (withRotation): 10 samples.
Epoch: 100	rescaled_fidelity = 0.942706	KL = 0.295004
Epoch: 200	rescaled_fidelity = 0.941764	KL = 0.300004
Epoch: 300	rescaled_fidelity = 0.954352	KL = 0.233615
Epoch: 400	rescaled_fidelity = 0.953802	KL = 0.236494
Epoch: 500	rescaled_fidelity = 0.957602	KL = 0.216617
Epoch: 600	rescaled_fidelity = 0.951487	KL = 0.248644
Epoch: 700	rescaled_fidelity = 0.947892	KL = 0.267575
Epoch: 800	rescaled_fidelity = 0.948410	KL = 0.264840
Epoch: 900	rescaled_fidelity = 0.952856	KL = 0.241459
Epoch: 1000	rescaled_fidelity = 0.955519	KL = 0.227502
Total time elapsed during training:  3.874 s
Threshold value is reached. Finish Learning.
Save the Callbacks:
rescaled_fidelity
KL
Start the baseline reconstruction.
Start measurement of 1(10 configurations).
0 samples generated.
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/1/10samples/query_by_amplitude_and_phase/baseline
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/../baseline_not_rotated/
Learn Training_data (10samples): 10 samples.
Epoch: 100	rescaled_fidelity = 0.916939	KL = 0.433573
Epoch: 200	rescaled_fidelity = 0.935495	KL = 0.333400
Epoch: 300	rescaled_fidelity = 0.936076	KL = 0.330294
Epoch: 400	rescaled_fidelity = 0.938119	KL = 0.319395
Epoch: 500	rescaled_fidelity = 0.935612	KL = 0.332773
Epoch: 600	rescaled_fidelity = 0.936054	KL = 0.330412
Epoch: 700	rescaled_fidelity = 0.932843	KL = 0.347592
Epoch: 800	rescaled_fidelity = 0.936089	KL = 0.330221
Epoch: 900	rescaled_fidelity = 0.941715	KL = 0.300264
Epoch: 1000	rescaled_fidelity = 0.942005	KL = 0.298723
Total time elapsed during training:  4.004 s
Learn Training_data (10samples): 10 samples.
Epoch: 100	rescaled_fidelity = 0.920555	KL = 0.413895
Epoch: 200	rescaled_fidelity = 0.932620	KL = 0.348789
Epoch: 300	rescaled_fidelity = 0.935091	KL = 0.335555
Epoch: 400	rescaled_fidelity = 0.935955	KL = 0.330941
Epoch: 500	rescaled_fidelity = 0.938961	KL = 0.314905
Epoch: 600	rescaled_fidelity = 0.933724	KL = 0.342874
Epoch: 700	rescaled_fidelity = 0.937060	KL = 0.325041
Epoch: 800	rescaled_fidelity = 0.941311	KL = 0.302407
Epoch: 900	rescaled_fidelity = 0.934166	KL = 0.340503
Epoch: 1000	rescaled_fidelity = 0.937973	KL = 0.320168
Total time elapsed during training:  3.799 s
Learn Training_data (10samples): 10 samples.
Epoch: 100	rescaled_fidelity = 0.924204	KL = 0.394112
Epoch: 200	rescaled_fidelity = 0.931996	KL = 0.352133
Epoch: 300	rescaled_fidelity = 0.936883	KL = 0.325985
Epoch: 400	rescaled_fidelity = 0.934081	KL = 0.340961
Epoch: 500	rescaled_fidelity = 0.931157	KL = 0.356636
Epoch: 600	rescaled_fidelity = 0.931194	KL = 0.356440
Epoch: 700	rescaled_fidelity = 0.938688	KL = 0.316362
Epoch: 800	rescaled_fidelity = 0.939912	KL = 0.309844
Epoch: 900	rescaled_fidelity = 0.937519	KL = 0.322591
Epoch: 1000	rescaled_fidelity = 0.938688	KL = 0.316359
Total time elapsed during training:  3.818 s
Learn Training_data (10samples): 10 samples.
Epoch: 100	rescaled_fidelity = 0.932282	KL = 0.350600
Epoch: 200	rescaled_fidelity = 0.932487	KL = 0.349502
Epoch: 300	rescaled_fidelity = 0.937741	KL = 0.321407
Epoch: 400	rescaled_fidelity = 0.938004	KL = 0.320004
Epoch: 500	rescaled_fidelity = 0.933762	KL = 0.342670
Epoch: 600	rescaled_fidelity = 0.937372	KL = 0.323377
Epoch: 700	rescaled_fidelity = 0.940862	KL = 0.304796
Epoch: 800	rescaled_fidelity = 0.934726	KL = 0.337508
Epoch: 900	rescaled_fidelity = 0.933905	KL = 0.341901
Epoch: 1000	rescaled_fidelity = 0.933816	KL = 0.342377
Total time elapsed during training:  4.008 s
