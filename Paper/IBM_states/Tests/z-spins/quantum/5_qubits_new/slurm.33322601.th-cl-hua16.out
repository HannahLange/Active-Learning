Matplotlib created a temporary config/cache directory at /tmp/user/23375/matplotlib-f74rpqsw because the default path (/project/theorie/h/Hannah.Lange/.cache/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
use quantum device ibmq_lima
------ Start GLOBAL rotations to different measurement configurations.------
Measure in Z basis.
Start measurement of 1(4 configurations).
0 samples generated.
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/1/withRotation/2samples/4samples
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/tmp
tensor([[1., 1., 1., 1., 0.],
        [1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1.]], dtype=torch.float64)
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.888629	KL = 0.590376
Epoch: 200	rescaled_fidelity = 0.911541	KL = 0.463095
Total time elapsed during training:  1.229 s
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.902773	KL = 0.511423
Epoch: 200	rescaled_fidelity = 0.920891	KL = 0.412067
Total time elapsed during training:  1.054 s
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.916237	KL = 0.437398
Epoch: 200	rescaled_fidelity = 0.927856	KL = 0.374395
Total time elapsed during training:  1.054 s
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.929070	KL = 0.367857
Epoch: 200	rescaled_fidelity = 0.928285	KL = 0.372082
Total time elapsed during training:  1.063 s
Measure in X basis.
Start measurement of 1(4 configurations).
0 samples generated.
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/1/withRotation/2samples/4samples
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/tmp
tensor([[1., 1., 1., 1., 0.],
        [0., 0., 0., 1., 1.],
        [1., 0., 0., 1., 1.],
        [0., 1., 1., 1., 1.]], dtype=torch.float64)
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.611483	KL = 2.459337
Epoch: 200	rescaled_fidelity = 0.629231	KL = 2.316284
Total time elapsed during training:  1.082 s
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.619013	KL = 2.398144
Epoch: 200	rescaled_fidelity = 0.637231	KL = 2.253116
Total time elapsed during training:  1.059 s
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.629948	KL = 2.310592
Epoch: 200	rescaled_fidelity = 0.627087	KL = 2.333349
Total time elapsed during training:  1.063 s
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.618793	KL = 2.399926
Epoch: 200	rescaled_fidelity = 0.632432	KL = 2.290916
Total time elapsed during training:  1.062 s
Measure in Y basis.
Start measurement of 1(4 configurations).
0 samples generated.
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/1/withRotation/2samples/4samples
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/tmp
tensor([[1., 1., 1., 1., 0.],
        [0., 0., 0., 1., 1.],
        [1., 1., 0., 0., 0.],
        [1., 0., 1., 0., 0.]], dtype=torch.float64)
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.430326	KL = 4.216056
Epoch: 200	rescaled_fidelity = 0.434532	KL = 4.167434
Total time elapsed during training:  1.082 s
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.467864	KL = 3.797891
Epoch: 200	rescaled_fidelity = 0.455682	KL = 3.929801
Total time elapsed during training:  1.062 s
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.477291	KL = 3.698143
Epoch: 200	rescaled_fidelity = 0.481386	KL = 3.655425
Total time elapsed during training:  1.070 s
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.476158	KL = 3.710028
Epoch: 200	rescaled_fidelity = 0.440146	KL = 4.103244
Total time elapsed during training:  1.060 s
[0.25117616916231317, 0.3451932531711659, 0.295169156930898]
Using the Z basis for the amplitude measurements.
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/tmp
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/../
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/1/withRotation/2samples/4samples
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.888629	KL = 0.590376
Epoch: 200	rescaled_fidelity = 0.911541	KL = 0.463095
Epoch: 300	rescaled_fidelity = 0.922493	KL = 0.403380
Epoch: 400	rescaled_fidelity = 0.924638	KL = 0.391765
Epoch: 500	rescaled_fidelity = 0.926830	KL = 0.379925
Epoch: 600	rescaled_fidelity = 0.926291	KL = 0.382834
Epoch: 700	rescaled_fidelity = 0.923736	KL = 0.396646
Epoch: 800	rescaled_fidelity = 0.931289	KL = 0.355927
Epoch: 900	rescaled_fidelity = 0.938874	KL = 0.315370
Epoch: 1000	rescaled_fidelity = 0.942339	KL = 0.296952
Total time elapsed during training:  5.293 s
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.902773	KL = 0.511423
Epoch: 200	rescaled_fidelity = 0.920891	KL = 0.412067
Epoch: 300	rescaled_fidelity = 0.928813	KL = 0.369237
Epoch: 400	rescaled_fidelity = 0.930187	KL = 0.361851
Epoch: 500	rescaled_fidelity = 0.933248	KL = 0.345423
Epoch: 600	rescaled_fidelity = 0.930265	KL = 0.361427
Epoch: 700	rescaled_fidelity = 0.936045	KL = 0.330457
Epoch: 800	rescaled_fidelity = 0.938265	KL = 0.318615
Epoch: 900	rescaled_fidelity = 0.939829	KL = 0.310285
Epoch: 1000	rescaled_fidelity = 0.939253	KL = 0.313353
Total time elapsed during training:  5.273 s
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.916237	KL = 0.437398
Epoch: 200	rescaled_fidelity = 0.927856	KL = 0.374395
Epoch: 300	rescaled_fidelity = 0.926997	KL = 0.379027
Epoch: 400	rescaled_fidelity = 0.937830	KL = 0.320931
Epoch: 500	rescaled_fidelity = 0.937189	KL = 0.324351
Epoch: 600	rescaled_fidelity = 0.943887	KL = 0.288746
Epoch: 700	rescaled_fidelity = 0.943561	KL = 0.290469
Epoch: 800	rescaled_fidelity = 0.938773	KL = 0.315910
Epoch: 900	rescaled_fidelity = 0.938282	KL = 0.318524
Epoch: 1000	rescaled_fidelity = 0.944855	KL = 0.283620
Total time elapsed during training:  5.350 s
Learn Training_data (withRotation): 4 samples.
Epoch: 100	rescaled_fidelity = 0.929070	KL = 0.367857
Epoch: 200	rescaled_fidelity = 0.928285	KL = 0.372082
Epoch: 300	rescaled_fidelity = 0.923522	KL = 0.397805
Epoch: 400	rescaled_fidelity = 0.932185	KL = 0.351122
Epoch: 500	rescaled_fidelity = 0.928486	KL = 0.370999
Epoch: 600	rescaled_fidelity = 0.940444	KL = 0.307018
Epoch: 700	rescaled_fidelity = 0.942732	KL = 0.294866
Epoch: 800	rescaled_fidelity = 0.940278	KL = 0.307900
Epoch: 900	rescaled_fidelity = 0.941393	KL = 0.301972
Epoch: 1000	rescaled_fidelity = 0.939188	KL = 0.313699
Total time elapsed during training:  5.285 s
Threshold value is reached. Finish Learning.
Save the Callbacks:
rescaled_fidelity
KL
Start the baseline reconstruction.
Start measurement of 1(4 configurations).
0 samples generated.
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/1/2samples/query_by_amplitude_and_phase/baseline
Bases, training bases, training samples and target statevector are saved in the folder: Training_data/../baseline_not_rotated/
Learn Training_data (2samples): 4 samples.
Epoch: 100	rescaled_fidelity = 0.866572	KL = 0.716051
Epoch: 200	rescaled_fidelity = 0.877926	KL = 0.650963
Epoch: 300	rescaled_fidelity = 0.874114	KL = 0.672724
Epoch: 400	rescaled_fidelity = 0.889334	KL = 0.586411
Epoch: 500	rescaled_fidelity = 0.889324	KL = 0.586469
Epoch: 600	rescaled_fidelity = 0.896984	KL = 0.543585
Epoch: 700	rescaled_fidelity = 0.894131	KL = 0.559514
Epoch: 800	rescaled_fidelity = 0.900629	KL = 0.523308
Epoch: 900	rescaled_fidelity = 0.894069	KL = 0.559862
Epoch: 1000	rescaled_fidelity = 0.886566	KL = 0.601997
Total time elapsed during training:  5.323 s
Learn Training_data (2samples): 4 samples.
Epoch: 100	rescaled_fidelity = 0.868844	KL = 0.702960
Epoch: 200	rescaled_fidelity = 0.877477	KL = 0.653525
Epoch: 300	rescaled_fidelity = 0.879377	KL = 0.642710
Epoch: 400	rescaled_fidelity = 0.888435	KL = 0.591471
Epoch: 500	rescaled_fidelity = 0.887007	KL = 0.599514
Epoch: 600	rescaled_fidelity = 0.883417	KL = 0.619789
Epoch: 700	rescaled_fidelity = 0.895198	KL = 0.553551
Epoch: 800	rescaled_fidelity = 0.886203	KL = 0.604045
Epoch: 900	rescaled_fidelity = 0.882244	KL = 0.626433
Epoch: 1000	rescaled_fidelity = 0.885503	KL = 0.607999
Total time elapsed during training:  5.285 s
Learn Training_data (2samples): 4 samples.
Epoch: 100	rescaled_fidelity = 0.871591	KL = 0.687173
Epoch: 200	rescaled_fidelity = 0.895827	KL = 0.550040
Epoch: 300	rescaled_fidelity = 0.889042	KL = 0.588055
Epoch: 400	rescaled_fidelity = 0.883826	KL = 0.617473
Epoch: 500	rescaled_fidelity = 0.888219	KL = 0.592687
Epoch: 600	rescaled_fidelity = 0.888806	KL = 0.589380
Epoch: 700	rescaled_fidelity = 0.889878	KL = 0.583354
Epoch: 800	rescaled_fidelity = 0.883621	KL = 0.618633
Epoch: 900	rescaled_fidelity = 0.879656	KL = 0.641122
Epoch: 1000	rescaled_fidelity = 0.883684	KL = 0.618278
Total time elapsed during training:  5.284 s
Learn Training_data (2samples): 4 samples.
Epoch: 100	rescaled_fidelity = 0.884084	KL = 0.616014
Epoch: 200	rescaled_fidelity = 0.890684	KL = 0.578827
Epoch: 300	rescaled_fidelity = 0.889721	KL = 0.584235
Epoch: 400	rescaled_fidelity = 0.890457	KL = 0.580102
Epoch: 500	rescaled_fidelity = 0.877972	KL = 0.650702
Epoch: 600	rescaled_fidelity = 0.881782	KL = 0.629050
Epoch: 700	rescaled_fidelity = 0.890244	KL = 0.581299
Epoch: 800	rescaled_fidelity = 0.890965	KL = 0.577249
Epoch: 900	rescaled_fidelity = 0.887942	KL = 0.594243
Epoch: 1000	rescaled_fidelity = 0.888918	KL = 0.588752
Total time elapsed during training:  5.255 s
